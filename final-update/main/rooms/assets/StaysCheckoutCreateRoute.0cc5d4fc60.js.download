__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;function s(){const t=r(d[1]);return s=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=t(r(d[2])),n=r(d[3]),h=r(d[4]);e.default=new class{constructor(){this.history=void 0,this.historyCallback=void 0,this.lastLoggedPathname=void 0,this.unlistenHistory=void 0,this.isClientRouteRequest=!1,this.history=void 0,this.unlistenHistory=void 0,this.historyCallback=void 0,this.lastLoggedPathname=void 0}setHistoryListener(t,s){this.history||(this.history=t,this.unlistenHistory=t.listen(this.onHistoryChange.bind(this)),void 0===this.lastLoggedPathname&&this.history.location&&(this.lastLoggedPathname=this.history.location.pathname)),s&&s!==this.historyCallback&&(this.historyCallback=s)}onHistoryChange(t,s){this.isClientRouteRequest=!0,this.historyCallback&&this.historyCallback(t,s)}logImpression({universalPageName:t,subpageName:l,eventData:u,eventDataSchema:v,impressionUuid:c,pageRequestMethod:y}){(0,h.getPageRequestMethod)(this.isClientRouteRequest).then((h=>{const p={schema:s().UniversalPageImpressionEvent,event_data:{page_name:t,subpage_name:l,referrer:document.referrer||'unknown',page_request_method:y||h,event_data:u,event_data_schema:v,impression_uuid:c,navigation_type:(0,n.getNavigationType)(),url:document.location.href}};o.default.logJitneyEvent(p)}))}hasMovedToNewPage(t,s,o){return'POP'===s||'PUSH'===s||!!o&&'REPLACE'===s&&t.pathname!==this.lastLoggedPathname}}}),"007d44",["ba7a76","bf254a","c8b97a","5d602b","6f10f0"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function({input:t,isCompact:n,queryRef:s,location:c}){const p=window.location?.pathname,u=s&&s.options?.operation?.operationId;t.orderId&&!t.confirmationCode&&(0,o.airdogCount)('stays_checkout.orchestration.missing_ids.missing_confirmation_code',1,{isCompact:n,pathname:p,operationId:u});t.confirmationCode&&!t.orderId&&(0,o.airdogCount)('stays_checkout.orchestration.missing_ids.missing_orderId',1,{isCompact:n,pathname:p,operationId:u})};var o=r(d[0])}),"02734c",["3e4681"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.getCheckoutMutationVariable=function({input:t,getPersistentQPData:n}){const o=k(t,n);return{input:{...C(t),quickPayData:o?{paymentDataRequest:o,quickPayCheckoutId:t.checkoutId}:null}}},e.getCheckoutQueryVariable=function({checkoutId:t,confirmationCodeOverride:n,isCompact:o,location:u,orderId:c,persistentQueryMetadata:p,getPersistentQPData:I,mockIdentifier:f}){const y={...(0,l.coerceStaysCheckoutParams)((0,s.default)(u.search)),checkoutId:t,isCompact:o,persistentQueryMetadata:p};n&&(y.code=n);c&&(y.orderId=c);const h=k(y,I);return{input:{...C(y),quickPayData:h?{paymentDataRequest:h,quickPayCheckoutId:t}:null},mockIdentifier:f}},e.reportStaysCheckoutInputError=function(t,n){const{bookingAttemptId:c,confirmationCode:s,productId:l,quickPayData:p}=t,I={hasBookingAttemptId:!!c,hasConfirmationCode:!!s,hasProductId:!!l,hasQuickPayData:!!p,origin:n};(0,o.airdogCount)('stays_checkout.api.input_error',1,I);const f=window.location?.search;(0,u.reportError)(new Error('[Checkout][Stays] Checkout API Input Error'),{extra:{...t,origin:n,search:f}})};var n=r(d[1]),o=r(d[2]),u=r(d[3]),c=t(r(d[4])),s=t(r(d[5])),l=r(d[6]),p=r(d[7]),I=r(d[8]),f=r(d[9]);function k(t,n){const o=n();if(null===o)return null;const u=JSON.parse(o);(0,p.shouldYieldSelectedPaymentOption)(u,t)&&u.payment_options_info&&(u.payment_options_info.selected_payment_option=void 0);const c=(0,I.convertToStableObjectOrder)(u);return JSON.stringify(c)}function y(t){return t&&f.airbnbOrgGuestTypes.includes(t)?t:void 0}function h({focusedListing:t,checkin:o,checkout:u,code:c,otherCheckin:s,otherCheckout:l,otherCode:p,otherListing:I,productId:f,splitStaysId:k}){if(!(I&&void 0!==t&&s&&l&&k))return;const y={checkinDate:o,checkoutDate:u,confirmationCode:c,productId:f?(0,n.createGlobalId)('StayListing',f):null},h={checkinDate:s,checkoutDate:l,confirmationCode:p,productId:I?(0,n.createGlobalId)('StayListing',I):null};return{splitStaysId:k,stays:0===t?[y,h]:[h,y]}}const b=()=>['LAUNCH_LOGIN_PHONE_AUTH'];function C(t){const{addOnType:o,affiliateId:u,airbnbOrgGuestType:s,airbnbOrgResponseId:l,bookingAttemptId:p,causeId:I,checkin:f,checkout:k,code:C,couponCode:O,disasterId:P,guestCheckinTime:T,guestCurrency:S,insuranceCode:v,isLrBooking:_,isWorkTrip:D,luxuryListingQuoteId:A,numberOfAdults:N,numberOfChildren:G,numberOfInfants:L,numberOfInstallments:Q,numberOfPets:E,openHomesAffiliated:q,orderId:H,pendingGuestEmail:M,pendingGuestId:R,pendingTripToken:w,persistentQueryMetadata:x,photoId:B,productId:F,ratePlanId:W,selectedCancellationPolicyId:j,specialOfferId:J,isWaitToPay:U}=t,{entryPoint:V}=x,Y=c.default.current().curr;return{businessTravel:{pendingGuestEmail:M,pendingGuestId:R,pendingTripToken:w,workTrip:D},bookingAttemptId:p,checkinDate:f,checkoutDate:k,splitStays:h(t),confirmationCode:C,couponCode:O,guestCheckinTime:T,guestCounts:'number'==typeof(N??G??L??E)?{numberOfAdults:Number(N)||1,numberOfChildren:Number(G)||0,numberOfInfants:Number(L)||0,numberOfPets:Number(E)||0}:null,guestCurrencyOverride:S||Y||null,insuranceCode:v,listingDetail:{photoId:B},lux:{isLrBooking:_,luxuryListingQuoteId:A},metadata:{entryPoint:V,internalFlags:b()},numberOfInstallments:Q,org:{affiliateId:u?String(u):void 0,causeId:Number(I)||void 0,disasterId:Number(P)||void 0,airbnbOrgGuestType:y(s),airbnbOrgResponseId:void 0!==l?String(l):void 0,openHomesAffiliated:!!q||void 0},orderId:H,productId:F?(0,n.createGlobalId)('StayListing',F):null,ratePlanId:W,selectedCancellationPolicyId:j,specialOfferId:J,addOn:{carbonOffsetParams:{isSelected:'CARBON_OFFSET'===o}},isWaitToPay:U}}}),"0f60a4",["ba7a76","56afe0","3e4681","f2f40f","06a99e","a7c4ef","261c30","9f33eb","735391","dc9188"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.QueryParamKeys=void 0,e.buildUrlInfo=function(t,o){return{urlParams:t.params,queryParams:_((0,n.default)(o.search)),location:o}},e.coerceStaysCheckoutParams=_;var n=t(r(d[1])),o=(function(t){return t.debug="debug",t.is_lr_booking="isLrBooking",t.isLrBooking="isLrBooking",t.work_trip="isWorkTrip",t.is_work_trip="isWorkTrip",t.isWorkTrip="isWorkTrip",t.open_homes_affiliated="openHomesAffiliated",t.openHomesAffiliated="openHomesAffiliated",t.remove_coupon_action="removeCouponAction",t.removeCouponAction="removeCouponAction",t.skip_coupon_auto_apply="skipCouponAutoApply",t.skipCouponAutoApply="skipCouponAutoApply",t.typed_payments="typedPayments",t.typedPayments="typedPayments",t.vacation_rental="vacationRental",t.vacationRental="vacationRental",t.isWaitToPay="isWaitToPay",t})(o||{}),s=(function(t){return t.affiliate_id="affiliateId",t.affiliateId="affiliateId",t.airbnb_org_guest_type="airbnbOrgGuestType",t.airbnbOrgGuestType="airbnbOrgGuestType",t.booking_attempt_id="bookingAttemptId",t.bookingAttemptId="bookingAttemptId",t.campaign_param="campaignParam",t.campaignParam="campaignParam",t.code="code",t.otherCode="otherCode",t.other_code="otherCode",t.orderId="orderId",t.coupon_code="couponCode",t.couponCode="couponCode",t.display_currency="guestCurrency",t.displayCurrency="guestCurrency",t.guest_currency="guestCurrency",t.guestCurrency="guestCurrency",t.partnership_external_id="partnershipExternalId",t.partnershipExternalId="partnershipExternalId",t.pendingGuestEmail="pendingGuestEmail",t.pendingTripToken="pendingTripToken",t.ratePlanId="ratePlanId",t})(s||{}),u=(function(t){return t.cause_id="causeId",t.causeId="causeId",t.disaster_id="disasterId",t.disasterId="disasterId",t.airbnb_org_response_id="airbnbOrgResponseId",t.airbnbOrgResponseId="airbnbOrgResponseId",t.guest_checkin_time="guestCheckinTime",t.guestCheckinTime="guestCheckinTime",t.adults="numberOfAdults",t.number_of_adults="numberOfAdults",t.numberOfAdults="numberOfAdults",t.children="numberOfChildren",t.number_of_children="numberOfChildren",t.numberOfChildren="numberOfChildren",t.guests="numberOfGuests",t.number_of_guests="numberOfGuests",t.numberOfGuests="numberOfGuests",t.infants="numberOfInfants",t.number_of_infants="numberOfInfants",t.numberOfInfants="numberOfInfants",t.pets="numberOfPets",t.number_of_pets="numberOfPets",t.numberOfPets="numberOfPets",t.otherAdults="otherAdults",t.other_adults="otherAdults",t.otherChildren="otherChildren",t.other_children="otherChildren",t.otherGuests="otherGuests",t.other_guests="otherGuests",t.otherInfants="otherInfants",t.other_infants="otherInfants",t.otherPets="otherPets",t.other_pets="otherPets",t.selected_cancellation_policy_id="selectedCancellationPolicyId",t.selectedCancellationPolicyId="selectedCancellationPolicyId",t.focusedListing="focusedListing",t.focused_listing="focusedListing",t.fov_flow_canceled="fovFlowCanceled",t.fovFlowCanceled="fovFlowCanceled",t})(u||{}),c=(function(t){return t.guest_id="guestId",t.guestId="guestId",t.luxury_listing_quote_id="luxuryListingQuoteId",t.luxuryListingQuoteId="luxuryListingQuoteId",t.number_of_installments="numberOfInstallments",t.numberOfInstallments="numberOfInstallments",t.pending_traveler_id="pendingTravelerId",t.pendingTravelerId="pendingTravelerId",t.pending_guest_id="pendingGuestId",t.pendingGuestId="pendingGuestId",t.insuranceCode="insuranceCode",t.addOnType="addOnType",t.product_id="productId",t.productId="productId",t.hosting_id="productId",t.otherListing="otherListing",t.other_listing="otherListing",t.security_deposit_id="securityDepositId",t.securityDepositId="securityDepositId",t.special_offer_id="specialOfferId",t.specialOfferId="specialOfferId",t.splitStaysId="splitStaysId",t.split_stays_id="splitStaysId",t.photoId="photoId",t})(c||{}),p=(function(t){return t.checkin="checkin",t.checkout="checkout",t.check_in="checkin",t.check_out="checkout",t.otherCheckin="otherCheckin",t.other_check_in="otherCheckin",t.otherCheckout="otherCheckout",t.other_check_out="otherCheckout",t})(p||{}),l=(function(t){return t.sectionIds="sectionIds",t})(l||{});const f=e.QueryParamKeys={...o,...s,...u,...c,...p,...l};function _(t,n=!1,p=!1){return Object.entries(t).reduce(((t,[l,_])=>{if(p&&void 0===_)return t;const h=f[l];return h?o[l]?''!==_&&'string'==typeof _?{...t,[h]:'true'===_}:'boolean'==typeof _?{...t,[h]:_}:t:u[l]?''===_||'string'!=typeof _||Number.isNaN(parseInt(_,10))?''!==_&&'number'==typeof _?{...t,[h]:_}:t:{...t,[h]:parseInt(_,10)}:c[l]?''!==_&&void 0!==_?{...t,[h]:String(_)}:t:''!==_||l===s.couponCode||l===s.coupon_code?{...t,[h]:_}:t:n?{...t,[l]:_}:t}),{})}}),"261c30",["ba7a76","a7c4ef"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default,n=r(d[1]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function({buildEventDataFromProps:t,eventDataSchema:n,trackReplaceNavigationsToNewPathnames:I=!1,universalPageName:E,subPageName:D,deprecatedIgnorePathnameUpdateForImpressions:b,ignorePathnameUpdate:C,includeHistoryUpdate:T}){if(t&&!n)throw new Error('withPagePerformanceScore: You must supply an event data schema if you supply an event data function.');return function(A){class L extends s.Component{constructor(t){super(t),this.bootstrappedApiLoggingContext=void 0,this.evaluatedEventDataSchema=void 0,this.evaluatedUniversalPageName=void 0,this.evaluatedSubPageName=void 0,this.eventDataSchema=void 0,this.impressionUuid=void 0,this.isInPageTransition=void 0,this.pageTransitionAcknowledgedByRender=void 0,this.previousPathname=void 0,this.lastLoggedPathname=void 0,this.deprecatedIgnorePathnameUpdateForImpressions=void 0,this.timeout=void 0,this.timestampOfInteractivity=void 0,this.ttfcpRequestAnimationFrameId=void 0,this.ignorePathnameUpdate=void 0,this.includeHistoryUpdate=void 0,this.onPageShow=t=>{t.persisted&&this.handlePageTransition()},this.getEvaluatedUniversalPageNames=()=>({evaluatedUniversalPageName:(0,U.evaluateUniversalPageName)(E,this.props),evaluatedSubPageName:D&&(0,U.evaluateSubpageName)(D,this.props)}),this.shouldSkipImpressionLogging=()=>{const{history:t}=this.props;return'function'==typeof this.deprecatedIgnorePathnameUpdateForImpressions&&t&&t.location&&this.lastLoggedPathname&&this.deprecatedIgnorePathnameUpdateForImpressions({prevPathname:this.lastLoggedPathname,nextPathname:t.location.pathname})},this.handleNewPageMount=()=>{const{history:t}=this.props,n=(0,P.updateJitneyClientSession)();u.default.addContext({client_session_id:n}),(0,v.storePageName)(window.document.URL,this.evaluatedUniversalPageName);const s=this.generateEventData();this.shouldSkipImpressionLogging()||(u.default.setImpressionMetadata({eventDataSchema:this.evaluatedEventDataSchema,initialEventData:s,impressionUuid:this.impressionUuid}),f.default.logImpression({universalPageName:this.evaluatedUniversalPageName,subpageName:this.evaluatedSubPageName,eventData:s,eventDataSchema:this.evaluatedEventDataSchema,impressionUuid:this.impressionUuid}),this.lastLoggedPathname=t&&t.location&&t.location.pathname),t&&f.default.setHistoryListener(t,((t,n)=>{if(f.default.hasMovedToNewPage(t,n,I)){if(this.pageTransitionAcknowledgedByRender)return void(this.pageTransitionAcknowledgedByRender=!1);this.isInPageTransition=!0}else(0,v.storePageName)(window.document.URL,this.evaluatedUniversalPageName)})),this.ttfcpRequestAnimationFrameId=requestAnimationFrame((()=>{const t={universalPageName:this.evaluatedUniversalPageName,subPageName:this.evaluatedSubPageName,impressionUuid:this.impressionUuid,timestampOfFCP:(0,c.default)().now(),eventData:s,eventDataSchema:this.evaluatedEventDataSchema};w.default.updateCurrentRecorderWithHOCProps(t)})),'function'==typeof this.ignorePathnameUpdate&&w.default.setIgnorePathnameUpdate(this.ignorePathnameUpdate),'function'==typeof this.includeHistoryUpdate&&w.default.setIncludeHistoryUpdate(this.includeHistoryUpdate)},this.eventDataSchema=n;const{evaluatedUniversalPageName:s,evaluatedSubPageName:l}=this.getEvaluatedUniversalPageNames();this.evaluatedUniversalPageName=s,this.evaluatedSubPageName=l,this.evaluatedEventDataSchema=(0,U.evaluateEventDataSchema)(n,t),this.isInPageTransition=!1,this.timestampOfInteractivity=null,this.previousPathname=t.location&&t.location.pathname,this.pageTransitionAcknowledgedByRender=!1,this.impressionUuid=(0,o().v4)();const N=p.default.get('api_logging_context');if(this.bootstrappedApiLoggingContext=void 0,this.deprecatedIgnorePathnameUpdateForImpressions=b,this.ignorePathnameUpdate=C,this.includeHistoryUpdate=T,N)try{'object'==typeof N?this.bootstrappedApiLoggingContext=N:'string'==typeof N&&(this.bootstrappedApiLoggingContext=JSON.parse(N))}catch(t){u.default.logJitneyEvent({schema:h().ApiLoggingContextMalformedBootstrapDataEvent,event_data:{payload:N,impression_uuid:this.impressionUuid}})}this.handlePageTransition=this.handlePageTransition.bind(this),this.generateEventData=this.generateEventData.bind(this),this.setContextForPage=this.setContextForPage.bind(this),this.setContextForPage()}componentDidMount(){window.performance&&'function'==typeof window.performance.mark&&window.performance.mark(N.HYDRATE_PERFORMANCE_HOC_MARK),this.handleNewPageMount(),'addEventListener'in window&&window.addEventListener('pageshow',this.onPageShow)}componentWillUnmount(){this.timeout&&window.clearTimeout(this.timeout),'removeEventListener'in window&&window.removeEventListener('pageshow',this.onPageShow),this.ttfcpRequestAnimationFrameId&&cancelAnimationFrame(this.ttfcpRequestAnimationFrameId),w.default.clearIgnorePathnameUpdate(),w.default.clearIncludeHistoryUpdate()}setContextForPage(){(0,l.setPageName)(this.evaluatedUniversalPageName),u.default.addContext({page_name:this.evaluatedUniversalPageName,impression_uuid:this.impressionUuid}),S&&u.default.addContext({previous_page_name:S}),S=this.evaluatedUniversalPageName}handlePageTransition(){this.isInPageTransition=!1,this.previousPathname=this.props.location&&this.props.location.pathname,this.timestampOfInteractivity=null;const{evaluatedUniversalPageName:t,evaluatedSubPageName:s}=this.getEvaluatedUniversalPageNames();this.evaluatedUniversalPageName=t,this.evaluatedSubPageName=s,this.evaluatedEventDataSchema=(0,U.evaluateEventDataSchema)(n,this.props),this.impressionUuid=(0,o().v4)(),this.setContextForPage(),u.default.setImpressionMetadata({eventDataSchema:this.evaluatedEventDataSchema,initialEventData:this.generateEventData(),impressionUuid:this.impressionUuid}),this.handleNewPageMount()}generateEventData(){const n=t&&t(this.props);if(n||this.bootstrappedApiLoggingContext)return{...n,...this.bootstrappedApiLoggingContext}}render(){const{history:t,location:n}=this.props;return this.isInPageTransition&&this.handlePageTransition(),n&&t&&this.previousPathname!==n.pathname&&(this.previousPathname=n.pathname,f.default.hasMovedToNewPage(n,t.action,I)?(this.handlePageTransition(),this.pageTransitionAcknowledgedByRender=!0):(0,v.storePageName)(window.document.URL,this.evaluatedUniversalPageName)),(0,y.jsx)(A,{...this.props})}}return L.propTypes={...A.propTypes||{}},L.defaultProps={...A.defaultProps||{}},L.displayName=`withPagePerformanceScore(${A.displayName||A.name||'Component'})`,L}};var s=n(r(d[2]));function o(){const t=r(d[3]);return o=function(){return t},t}function h(){const t=r(d[4]);return h=function(){return t},t}t(r(d[5]));var p=t(r(d[6])),u=t(r(d[7])),l=r(d[8]),v=r(d[9]),c=t(r(d[10])),P=r(d[11]),f=t(r(d[12])),U=r(d[13]),N=r(d[14]),w=t(r(d[15])),y=r(d[16]);let S}),"3a6fa9",["ba7a76","45f788","07aa1f","305dd5","de621c","29c0a5","ef2bc3","c8b97a","33392f","861735","5d602b","82f976","007d44","f85727","364f02","5c13fa","b8c07d"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=s,e.replaceToHistory=function(t,n={}){s((0,o.getHistory)(),t,n)};var n=t(r(d[1])),o=r(d[2]);function s(t,o,{maintainScrollPosition:s=!1,maintainQueryParams:l=!1,maintainHash:u=!1,params:c,state:f}={}){const p=(0,n.default)(o,{maintainQueryParams:l,maintainHash:u,params:c});t.replace(p,f),g.window&&!s&&g.window.scrollTo(0,0)}}),"4ee5a9",["ba7a76","be6a20","7934b6"]);
__d((function(g,r,i,a,m,e,d){"use strict";function n(n){return window.btoa(n)}function t(n,t){return`${n}:${encodeURIComponent(t).replace(/%20/g,'+').replace(/\(/g,'%28').replace(/\)/g,'%29')}`}function o(n){const t=n.split(':'),[o,c]=t,l=c&&decodeURIComponent(c.replace(/\+/g,'%20').replace(/%28/g,'(').replace(/%29/g,')'));if(void 0===o||void 0===l)throw new Error('Failed to decode global ID');return{typename:o,internalId:l}}Object.defineProperty(e,"__esModule",{value:!0}),e.createGlobalId=function(o,c){return n(t(o,c))},e.getInternalId=function(n){const{internalId:t}=o((c=n,window.atob(c)));var c;return t},e.parseGlobalId=function(n){return n},e.stringifyGlobalId=function(n){return n}}),"56afe0",[]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.updateCache=void 0;var n=t(r(d[1])),o=r(d[2]);const u=(t,n)=>{if(n&&t?.paymentDataRequest){const u=JSON.parse(t.paymentDataRequest),s=JSON.stringify((0,o.convertToStableObjectOrder)({...u,bill_info:{...u?.bill_info,bill_item_product_id:n}}));return{...t,paymentDataRequest:s}}return t};e.updateCache=({proxy:t,stayCheckout:o,variables:s})=>{const c=o?.sections?.metadata?.confirmationCode||void 0,p=u(s?.input?.quickPayData,c),l={input:{...s.input,confirmationCode:c,quickPayData:p}};t.writeQuery({query:n.default,variables:l,data:{presentation:{__typename:'RootPresentationContainer',stayCheckout:o}}})}}),"5c0dc9",["ba7a76","db1041","735391"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.convertToStableObjectOrder=function t(o){if(Array.isArray(o))return o.map((o=>t(o)));if('object'==typeof o&&null!==o){const n=o;return'function'==typeof n.toJSON?t(n.toJSON()):Object.keys(o).sort().reduce(((n,c)=>(n[c]=t(o[c]),n)),{})}return o}}),"735391",[]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.getCheckoutPrepareMutationVariables=e.default=void 0;var o=t(r(d[1])),u=r(d[2]),c=r(d[3]),s=t(r(d[4])),n=t(r(d[5])),p=r(d[6]);const l=({params:t,isCompact:o})=>(0,p.getCheckoutMutationVariable)({input:{...t,checkoutId:null,isCompact:o,persistentQueryMetadata:{}},getPersistentQPData:()=>null});e.getCheckoutPrepareMutationVariables=l;e.default=({cookie:t,isPrefetch:C,location:f,loadQuery:h})=>{const{search:y}=f,k=(0,c.coerceStaysCheckoutParams)((0,o.default)(y)),_=t(u.FORM_FACTOR_COOKIE)===u.FORM_FACTOR.COMPACT,M=l({params:k,isCompact:_}),{input:O}=M,{productId:P}=O;if(!P){const t=C?'StaysCheckoutCreateRoute.prepare.prefetch_mutation':'StaysCheckoutCreateRoute.prepare_mutation';(0,p.reportStaysCheckoutInputError)(O,t)}const R=h({query:s.default,variables:M});return(0,n.default)({input:O,isCompact:_,queryRef:R,location:f}),{queryRef:R}}}),"80cc43",["ba7a76","a7c4ef","b679e8","261c30","db1041","02734c","0f60a4"]);
__d((function(g,r,i,a,m,e,d){"use strict";var n=r(d[0]).default;function t(){const n=r(d[1]);return t=function(){return n},n}Object.defineProperty(e,"__esModule",{value:!0}),e.updateJitneyClientSession=function(){const n=(new Date).getTime()/1e3;u(n)?f(n):y(n);return c};var s=r(d[2]),o=n(r(d[3]));let l=0,c=null;function _(){return'treatment'===o.default.findTreatment('jitney_reclassification_v1',{log:!1})}function u(n){if(n-l<1800)return!0;const t=!_(),o=(0,s.getCookieSync)('jitney_client_session_id',{internalOnly:t}).value,u=(0,s.getCookieSync)('jitney_client_session_created_at',{internalOnly:t}).value,y=(0,s.getCookieSync)('jitney_client_session_updated_at',{internalOnly:t}).value;return c=o,o&&u&&y&&n-parseInt(u,10)<86400&&n-parseInt(y,10)<1800}function y(n){const o=(0,t().v4)(),u=!_();(0,s.setCookieSync)('jitney_client_session_id',o,{internalOnly:u}),(0,s.setCookieSync)('jitney_client_session_created_at',`${n}`,{internalOnly:u}),(0,s.setCookieSync)('jitney_client_session_updated_at',`${n}`,{internalOnly:u}),l=n,c=o}function f(n){requestIdleCallback((()=>{const t=!_();(0,s.setCookieSync)('jitney_client_session_updated_at',`${n}`,{internalOnly:t})})),l=n}}),"82f976",["ba7a76","305dd5","13babd","dcc72a"]);
__d((function(g,r,i,a,m,e,d){"use strict";var n=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.getPageName=function(n){return o=$(n),h(o)||(0,t.default)(p+o);var o},e.storePageName=function(n,s){const u=$(n),f=h(u);if(!f)try{(0,t.default)(p+u,s,{expires:c})}catch(n){const t=n instanceof Error?n:new Error(String(n));(0,o.warn)(t,{extra:{fromJitneyCache:!0,pageName:f},originalError:n instanceof Error?n:void 0})}};var t=n(r(d[1])),o=r(d[2]);const p='jitney_page_name_',c=36e5,s='[/#?]?$',u='[^/#?]+?',f=[{path:new RegExp(`/experiences/${u}${s}`),pageName:3003},{path:new RegExp(`/rooms/plus/${u}${s}`),pageName:3001},{path:new RegExp(`/rooms/${u}${s}`),pageName:3e3},{path:new RegExp(`/s/guidebooks${s}`),pageName:1006},{path:new RegExp(`/s/${u}${s}`),pageName:2e3}];function h(n){const t=f.find((({path:t})=>{const o=n.match(t);return o&&o[0]===n}));return t?t.pageName:null}function $(n){const{pathname:t}=new URL(n,'https://airbnb.com');return t}}),"861735",["ba7a76","1f339e","f2f40f"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default,o=r(d[1]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.mutateSearchWithParams=R;var s=o(r(d[2]));function u(){const t=r(d[3]);return u=function(){return t},t}var n=t(r(d[4])),c=t(r(d[5])),f=t(r(d[6])),l=r(d[7]),y=t(r(d[8])),h=o(r(d[9])),C=r(d[10]),_=r(d[11]),v=t(r(d[12])),p=r(d[13]),b=r(d[14]);function k(){const t=r(d[15]);return k=function(){return t},t}var O=r(d[16]),P=r(d[17]),I=t(r(d[18])),$=r(d[19]),M=r(d[20]);function R({confirmationCode:t,orderId:o,params:s,staysData:n}){const f=c.default.current().curr,{numberOfGuests:l,guestCurrency:y}=s,h={...s,code:t,orderId:o,guestCurrency:y||f||void 0},C=!(void 0!==l||!n);if(!(0,p.isCheckoutStateRecoveryKillswitchOn)()&&C){const{numberOfAdults:t,numberOfChildren:o,numberOfGuests:s,numberOfInfants:c,numberOfPets:f}=n||{},l={numberOfAdults:t??void 0,numberOfChildren:o??void 0,numberOfGuests:s??void 0,numberOfInfants:c??void 0,numberOfPets:f??void 0,...h};return(0,b.warn)('[Checkout][Stays] create route recovery flow triggered',{extra:{updatedParams:h,staysData:n}}),`?${(0,u().stringify)(l)}`}return`?${(0,u().stringify)(h)}`}e.default=(0,v.default)({universalPageName:4003,includeHistoryUpdate:()=>!1})((({location:t,queryRef:o})=>{const v=(0,k().useNiobeMinimalistClient)(),{search:b}=t,S=(0,s.useMemo)((()=>(0,_.coerceStaysCheckoutParams)((0,f.default)(b))),[b]),{productId:T}=S,A=(0,h.default)()===h.FORM_FACTOR.COMPACT,{data:D,error:H}=(0,k().useMinimalistPreloadedQuery)({query:I.default,queryRef:o});return T||(0,P.reportStaysCheckoutInputError)(S,'StaysCheckoutCreateRoute_mutation'),(0,s.useEffect)((()=>{(0,C.airdogCount)('checkout.stays.route.first_render',1,{has_data:!!D,route:'stays_create_route',is_compact:A,checkout_prefetch_on_hover_v2:A?'compact':n.default.findTreatment('checkout_prefetch_on_hover_v2',{log:!1})}),c.default.isLoggedIn()||(0,p.shouldPrefetchLoggedOutStaysCheckout)({isCompact:A,log:!0,source:'stays_create_route'})}),[]),(0,s.useEffect)((()=>{if(D?.presentation?.stayCheckout){const{stayCheckout:t}=D.presentation,o=t.sections?.metadata?.orderId||void 0,s=R({confirmationCode:t.sections?.metadata?.confirmationCode||void 0,orderId:o,params:S,staysData:t.sections?.stateMutation||void 0}),u=(0,O.getCheckoutPrepareMutationVariables)({params:{...S,orderId:o},isCompact:A});(0,$.updateCache)({proxy:v,stayCheckout:t,variables:u}),(0,l.replaceToHistory)(`/book/stays/${T}${s}`)}else if(H){(0,C.airdogCount)('stays_checkout.create_route.error',1);const t=`?${(0,u().stringify)(S)}`;(0,l.replaceToHistory)(`/book/stays/${T}${t}`)}else if(!(0,p.shouldCreateRouteWaitForData)()){(0,C.airdogCount)('stays_checkout.create_route.missing_data');const t=`?${(0,u().stringify)(S)}`;(0,l.replaceToHistory)(`/book/stays/${T}${t}`)}}),[D,H,A,T,S,v]),(0,M.jsx)(y.default,{})}))}),"8c3699",["ba7a76","45f788","07aa1f","e950a3","dcc72a","06a99e","a7c4ef","4ee5a9","716ec2","e0b071","3e4681","261c30","3a6fa9","964019","f2f40f","068abc","80cc43","0f60a4","db1041","5c0dc9","b8c07d"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.isCheckoutStateRecoveryKillswitchOn=function(){return o.default.getBootstrap('checkout_state_recovery_killswitch')},e.shouldCreateRouteWaitForData=e.shouldAllowM1MonthlyStaysComponent=e.shouldAllowCheckoutToolsTesting=void 0,e.shouldPrefetchCheckout=function(){return o.default.getBootstrap('checkout_gp_migration_prefetch_web')},e.shouldPrefetchLoggedOutStaysCheckout=function({isCompact:t,log:o,source:_}){const c=u.default.findTreatment('checkout_disable_prefetch_logged_out_web',{log:o});return(0,s.airdogCount)('checkout.stays.desktop.disable_prefetch_logged_out',1,{source:_,checkout_disable_prefetch_logged_out_web:c,compact:t}),'treatment'!==c},e.shouldShowFirstMessagePrompt=function({deliverExperiment:t,isCompact:u}){if(o.default.getBootstrap('checkout_first_message_prompt_force_in'))return!0;if(u){if(o.default.getBootstrap('checkout_first_message_prompt_moweb_v1'))return t?_.default.deliverExperiment('checkout_first_message_prompt_moweb_v1',{treatment:()=>!0,control:()=>!1,treatment_unknown:()=>!1}):'treatment'===_.default.findTreatmentWithoutLogging('checkout_first_message_prompt_moweb_v1')}else if(o.default.getBootstrap('checkout_first_message_prompt_web_v1'))return t?_.default.deliverExperiment('checkout_first_message_prompt_web_v1',{treatment:()=>!0,control:()=>!1,treatment_unknown:()=>!1}):'treatment'===_.default.findTreatmentWithoutLogging('checkout_first_message_prompt_web_v1');return!1},e.shouldUrlCacheOrderId=void 0;var o=t(r(d[1])),_=t(r(d[2])),u=t(r(d[3])),s=r(d[4]);e.shouldUrlCacheOrderId=()=>o.default.getBootstrap('checkout_p4_order_id_url_cache_enabled');e.shouldCreateRouteWaitForData=()=>o.default.getBootstrap('checkout_create_route_wait_for_data_enabled');e.shouldAllowCheckoutToolsTesting=()=>!o.default.getBootstrap('checkout.tools.data_mutation.killswitch');e.shouldAllowM1MonthlyStaysComponent=()=>!o.default.getBootstrap('web.payments.monthly_stays.monthly_pricing_kill_switch')}),"964019",["ba7a76","c235f8","fc0842","dcc72a","3e4681"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.shouldYieldSelectedPaymentOption=void 0;var l=t(r(d[1]));e.shouldYieldSelectedPaymentOption=(t,n)=>{const{isWorkTrip:o,openHomesAffiliated:s}=n,{id:u}=l.default.current(),{user_id:_,bill_info:{is_business_travel:c}}=t;return!!(!c&&o||!c&&s||_!==u)}}),"9f33eb",["ba7a76","06a99e"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u=t(r(d[1]));const f={document:void 0,getDocument:()=>r(d[3])(d[2]).then(u.default).then((t=>t.default)),name:'stayCheckout',type:'query',operationId:'a46f8979bb77e6022f4a1df12b7da54b521665236e65fb95edea5d2fc0d78d67'};e.default=f}),"db1041",["ba7a76","45f788","9f920f","057569"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.airbnbOrgGuestTypes=void 0;e.airbnbOrgGuestTypes=["CLIENT","ORGANIZATION_MEMBER","SELF"]}),"dc9188",[]);
__d((function(g,r,i,a,m,e,d){'use strict';Object.defineProperty(e,"__esModule",{value:!0});var t=e.ApiLoggingContextMalformedBootstrapDataEvent={defaultProps:{schema:'com.airbnb.jitney.event.logging.ApiLoggingContext:ApiLoggingContextMalformedBootstrapDataEvent:1.0.0',event_name:'apiloggingcontext_malformed_bootstrap_data'},propTypes:{}};t.fullyQualifiedName='ApiLoggingContext.v1.ApiLoggingContextMalformedBootstrapDataEvent',t.emissionDisabled=!0}),"de621c",[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.evaluateEventDataSchema=function(t,n){if('object'==typeof t)return t;if('function'==typeof t){const u=t(n);if('object'!=typeof u&&void 0!==u)return;return u}return},e.evaluateSubpageName=function(t,n){if('function'==typeof t){return t(n)}return t},e.evaluateUniversalPageName=function(t,n){if('function'==typeof t){return t(n)}return t}}),"f85727",[]);
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/frontend/gp-stays-checkout-route/routes/StaysCheckoutRoute/StaysCheckoutCreateRoute.1a35747922.js.map